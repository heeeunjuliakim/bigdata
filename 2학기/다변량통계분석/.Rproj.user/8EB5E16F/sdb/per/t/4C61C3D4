{
    "collab_server" : "",
    "contents" : "install.packages(\"MVA\")\nlibrary(MVA)\ndemo(\"Ch-MVA\")\nhead(USairpollution)\n\nhist(USairpollution_S)\nboxplot(USairpollution_S)\n\n#산점도 그리기\nplot(popul~manu, USairpollution)                 #방법 1\nplot(USairpollution$manu, USairpollution$popul)  #방법2\n\n#x y축 명을 바꾸고 싶다면\nplot(USairpollution$manu, USairpollution$popul,\n     xlab=\"Manufactureing enterprising with 20 or more workers\",\n     ylab=\"Population size\",\n     main=\"US airpollution\")\n\n\nlibrary(psych)\npairs.panels(USairpollution)   \n#대각선에 나오는 히스토그램들은 단변량 확인 가능\n#오른쪽 상단 :  상관계수값\n\ncorr.test(USairpollution)  #상관계수, P-value 확인 가능\n\n#이상치를 제외해보자!\n#방법1 ) max값을 찾아서 검색\nhead(USairpollution)\nsummary(USairpollution)\nUSairpollution[USairpollution$manu==3344,]\nUSairpollution[USairpollution$manu>2500,]\n\n#방법2 )\nplot(USairpollution$manu, USairpollution$popul)  \nidentify(USairpollution$manu, USairpollution$popul,labels=rownames(USairpollution))\nwindows()\n\n#도시명이 위의 4개인 값(이상치)들의 rownames를 뽑아내라.\noutcity <- match(c(\"Chicago\",\"Detroit\",\"Houston\", \"Philadelphia\"),\n                 rownames(USairpollution))   \nUSairpollution[outcity,]\n\npairs.panels(USairpollution[-outcity,])   #이상치값을 제외하고 다시 그려보자.\n\n##버블차트\nwith(USairpollution, symbols(temp, wind, circles=sqrt(SO2), inches=0.5))  #SO2의 크기에 따라 버블 그림\n # -> 온도와 바람에 따른 오염도의 상관관계\n\nwith(USairpollution, symbols(temp, wind, circles=sqrt(SO2), inches=0.5))\n\n\n##모자이크 플롯\nUCBAdmissions    #테스트 데이터\nUCBAdmissions[,,2] #1번 테이블만 뽑을 때\nUCBAdmissions[,1,] #합격 불합격\nUCBAdmissions[1,,] #성별\n\nmosaicplot(~Dept+Gender, \n           data=UCBAdmissions, color=T)\n\nmosaicplot(~Gender+Dept, \n           data=UCBAdmissions, color=T)\n\n#상자그림\nhead(chickwts)\nsummary(chickwts)\nboxplot(weight~feed, chickwts)\n\n#나이팅게일 차트\nstars(USairpollution, cex=0.7, key.loc=C(15,2), draw.segments = TRUE)\n\n\n######문제\n#1.\tCrime.csv는 2005년 미국의 범죄율 데이터로 범죄 유형별 발생건을 인구 100,000명 중의 발생 비율로 표시하였다. 살인, 강도, 폭행, 절도 등 총 7가지 범죄를 포함하는데 \n#   이 중 살인(murder)와 절도(burglary) 사이의 관계를 살피려고 한다. \n#A.\t두 변수 사이의 산점도를 단변량 분포와 함께 그리시오. 상관계수도 함께 살피시오.\nCrime <- read.csv(\"Crime.csv\")\nsummary(Crime)\nhead(Crime)\nplot(murder~burglary, Crime) #산점도\ninstall.packages(\"psych\")\nlibrary(psych)\npairs.panels(Crime)   #단변량 분포, 상관계수\ncorr.test(Crime[,-1]) #상관계수 \"0.28\"\n\n#B.\t위를 통해 이상점 존재여부를 판단하고 존재한다면 해당 주를 확인하고 제거하시오. 제거 후 변수들 사이의 관계가 어떻게 변화하는지 살피시오.\nplot(murder~burglary, Crime) #산점도\nidentify(Crime$murder, Crime$burglary, labels=Crime$state)\n\nout <- match(c(\"United States\",\"Alaska\",\"District of Columbia\"), Crime$state)\nclr <- rep(1,dim(Crime)[1])  #1을 Crime의 변수만큼 1을 만들어라.\nclr[out] <- 2                #미국, 알래스카, DC에 해당하는 인덱스에만 2를 넣어라.\nwindows()\nplot(murder~burglary, Crime[-out,])\ncorr.test((Crime[-out,])[,-1])  #상관계수 \"0.62\"\n\n\npairs(Crime[,-1], col=clr, pch=clr) #2의 값만 빨강으로 출력\ninstall.packages(\"psych\")\nlibrary(psych)\npairs.panels(Crime) #단변량분포\ncorr.test(Crime)  #상관계수, P-value 확인 가능\n\nidentify(Crime$murder, Crime$burglary, labels=Crime$state)\nidentify(Crime$murder, Crime$burglary, labels=rownames(Crime[,1]))  #????\n\n#C.\t살인, 절도와 인구(population)의 관계를 함께 관찰하기 위해 bubble plot을 그리고 관찰한 사실을 기술하시오.\nwith(Crime, symbols(Crime$murder, Crime$burglary, circles =sqrt(population), inches = 0.5))\n\n#D.\t7가지 범죄의 발생 건수를 heatmap, 별그림, 나이팅게일 차트로 표현하고 범죄 발생 특징 간의 패턴이 비슷한 주들이 있는지 살피시오.\n\nhead(Crime)\nheatmap(matrix(Crime3), Rowv=NA, Colv=NA, scale=\"column\", margins=c(5,10), col=brewer.pal(9,\"Blues\"))\n?heatmap\n\nCrime2 <- Crime[,-1]\nCrime3 <- Crime2[,-8]\nstr(Crime3)\nmatrix(Crime3)\n\nstars(Crime, cex=0.7, key.loc = c(15,2))\nstars(Crime, cex=0.7, key.loc=c(15,2), draw.segments = TRUE)\nidentify(Crime$murder, Crime$burglary, labels=Crime$state)\n",
    "created" : 1473466128595.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2670049750",
    "id" : "4C61C3D4",
    "lastKnownWriteTime" : 1474018930,
    "last_content_update" : 1474018930830,
    "path" : "C:/Users/hehe2/Desktop/다변량통계분석/lecture2.R",
    "project_path" : "lecture2.R",
    "properties" : {
        "tempName" : "Untitled2"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}